{% extends 'static/base.html' %}


{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<h1>Dodaj pacjenta</h1>
<br/>
<h5>Dane</h5>
<form action="" method="POST">
    {% csrf_token %}   
    <div class="d-flex">
        <p style="margin-right: 5px;">{{ user_form.hcc_number }}</p>
        <p style="margin-right: 5px; width: 16%;">{{ user_form.date }}</p>
        <p style="margin-right: 5px;">{{ user_form.name }}</p>
        <p style="margin-right: 5px;">{{ user_form.phone }}</p>
        <p style="margin-right: 5px;">{{ user_form.pesel }}</p>
        <p>{{ user_form.email }}</p> 
    </div>
   
    <div class="d-flex flex-row">
        <p style="margin-right: 5px; width: 16%;">{{ base_form.grupa_krwi }}</p>
        <p style="margin-right: 5px;">{{ base_form.age }}</p>
        <p style="margin-right: 5px;">{{ base_form.patient_height }}</p>
        <p style="margin-right: 5px;">{{ base_form.patient_weight }}</p>
        <p style="margin-right: 5px; width: 16%;">{{ base_form.gender }}</p>
        <p>{{ base_form.ecog }}</p>
    </div> 

    <br/>
    <h5>Infomacje o guzie</h5>
    <div class="d-flex">
        <p style="margin-right: 5px;">{{ thumor_form.thumor_number }}</p>
    </div>
    <div class="d-flex flex-row">
        <p style="margin-right: 5px; width: 16%;">{{ thumor_form.thumor1_segment1 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor1_segment2 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor1_segment3 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor1_diameter }}</p>
    </div>
    <div class="d-flex flex-row">
        <p style="margin-right: 5px; width: 16%;">{{ thumor_form.thumor2_segment1 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor2_segment2 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor2_segment3 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor2_diameter }}</p>
    </div>
    <div class="d-flex flex-row">
        <p style="margin-right: 5px; width: 16%;">{{ thumor_form.thumor3_segment1 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor3_segment2 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor3_segment3 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor3_diameter }}</p>
    </div>
    <div class="d-flex flex-row">
        <p style="margin-right: 5px; width: 16%;">{{ thumor_form.thumor4_segment1 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor4_segment2 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor4_segment3 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor4_diameter }}</p>
    </div>
    <div class="d-flex flex-row">
        <p style="margin-right: 5px; width: 16%;">{{ thumor_form.thumor5_segment1 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor5_segment2 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor5_segment3 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor5_diameter }}</p>
    </div>
    <div class="d-flex flex-row">
        <p style="margin-right: 5px; width: 16%;">{{ thumor_form.thumor6_segment1 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor6_segment2 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor6_segment3 }}</p>
        <p style="margin-right: 5px;">{{ thumor_form.thumor6_diameter }}</p>
    </div>
    <div class="d-flex">
        <p style="margin-right: 5px;">{{ thumor_form.top_diameter }}</p>
    </div>
   

    <!-- {{ thumor_formset.management_form }}   Needed for formset management

    <div id="thumor-formset-div">
        {% for form in thumor_formset.forms %}
            <div class="thumor-form thumor-form-{{ forloop.counter }}" style="display: '{% if forloop.counter > 1 %};none{% endif %};'">
                {{ form.as_table }}
            </div>
        {% endfor %}
    </div>
  <button type="button" class="btn btn-outline-secondary" id="add-student-button">Add Another Student</button>
        <br><br> --
   <button type="submit" class="btn btn-outline-warning">Submit</button> --> 

    <br>
    <!--  -->
    <h5>Badania laboratoryjne</h5>
    <div class="d-flex flex-row ">
        <p style="margin-right: 5px; font-size: 12px; width: 16%;">Data badania{{ lab_form.lab_date }}</p>
        <p style="margin-right: 5px; font-size: 12px;">Albumina<br/>{{ lab_form.albuminy }}</p> 
        <p style="margin-right: 5px; font-size: 12px;">INR<br/>{{ lab_form.inr}}</p>
        <p style="margin-right: 5px; font-size: 12px;">Kreatynina<br/>{{ lab_form.kreatynina }}</p>
        <p style="margin-right: 5px; font-size: 12px;">Sód surowica<br/>{{ lab_form.sod_surowica }}</p>
        <p style="margin-right: 5px; font-size: 12px;">Billirubina cał<br/>{{ lab_form.bilirubina_cal }}</p>
    </div>
    <div class="d-flex flex-row">
        <p style="margin-right: 5px; font-size: 12px;">Li-Rads{{ lab_form.li_rads_hcc }}</p>
        <p style="margin-right: 5px; font-size: 12px;">AFP<br/>{{ lab_form.afp }}</p> 
        <p style="margin-right: 5px; font-size: 12px;">PLT<br/>{{ lab_form.plt }}</p>
        <p style="margin-right: 5px; font-size: 12px;">CEA<br/>{{ lab_form.cea }}</p>
        <p style="margin-right: 5px; font-size: 12px;">CA19-9<br/>{{ lab_form.ca19_9 }}</p>
        <p style="margin-right: 5px; font-size: 12px;">Cukrzyca<br/>{{ lab_form.cukrzyca }}</p>
    </div>

    <div class="d-flex flex-row">
        <p style="margin-right: 5px; font-size: 12px;">Marskość<br/>{{ lab_form.marskosc }}</p> 
        <p style="margin-right: 5px; font-size: 12px;">Wodobrzusze<br/>{{ lab_form.wodobrzusze }}</p>
        <p style="margin-right: 5px; font-size: 12px;">Encefalopatia<br/>{{ lab_form.encefalopatia }}</p>
        <p style="margin-right: 5px; font-size: 12px;">HBV<br/>{{ lab_form.hbv }}</p>
        <p style="margin-right: 5px; font-size: 12px;">HCV<br/>{{ lab_form.hcv }}</p>
        <p style="margin-right: 5px; font-size: 12px;">Dezyzja po konsylium{{ user_form.decision }}</p>
    </div>
    <br/>
    <div class="row">
        <div class="col">
            <p>{{ lab_form.kommentarz }}</p>
        </div>
        <div class="col">
            <p>{{ lab_form.leczenie }}</p>
        </div>
    </div>
    <br/>
    <a class="btn btn-outline-secondary" href="{% url 'home' %}">Anuluj</a>
    <button type="submit" class="btn btn-warning">Dodaj</button>            
</form>

</br></br>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        let patientThumorCount = 1;  // Initial form count (we start with 1 patient form)
        const maxThumor = 3;     // Maximum number of thumor forms allowed

        const addThumorButton = document.getElementById('add-student-button');
        const thumorFormsetDiv = document.getElementById('thumor-formset-div');

        addThumorButton.addEventListener('click', function() {
            if (patientThumorCount < maxThumor) {
                patientThumorCount += 1;
                const nextThumorForm = document.querySelector(`.thumor-form-${patientThumorCount}`);
                nextYhumorForm.style.display = 'block';  // Reveal the next student form
            }
            if (patientThumorCount === maxThumor) {
                addThumorButton.style.display = 'none';  // Hide the add button after 3 students
            }
        });
    });
</script>
{{ redirect_to_login_immediately }}

{% endblock %}